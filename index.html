<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DaBoyzz Chat ðŸ”¥</title>
  <style>
    body { margin: 0; background: #101010; color: #f1f1f1; font-family: Arial, sans-serif; }
    h1 { text-align: center; color: #ff4040; margin-top: 25px; margin-bottom: 10px; font-size: 32px; }
    #loginScreen, #chatScreen { padding: 20px; display: block; }
    #loginBox { max-width: 360px; margin: 60px auto; background: #1b1b1b; padding: 25px; border-radius: 12px; box-shadow: 0 0 20px #000; }
    input, button { width: 100%; padding: 12px; border-radius: 6px; font-size: 15px; background: #262626; color: #fff; border: none; margin: 8px 0; }
    button { background: #ff4040; font-weight: bold; cursor: pointer; }
    button:hover { background: #ff2222; }
    #chatBox { margin-top: 15px; height: 420px; background: #191919; border: 2px solid #333; overflow-y: auto; padding: 12px; border-radius: 10px; }
    .msg { padding: 6px 0; border-bottom: 1px solid #2a2a2a; }
    .user { font-weight: bold; color: #ff7777; }
  </style>
</head>
<body>

<!-- LOGIN SCREEN -->
<div id="loginScreen">
  <h1>DaBoyzz Chat ðŸ”¥</h1>
  <div id="loginBox">
    <h3>Login With Username</h3>
    <input id="userInput" placeholder="Username">
    <input id="passInput" type="password" placeholder="Password">
    <button onclick="usernameLogin()">Login / Register</button>
    <br><br>
    <h3>Or Continue as Guest</h3>
    <button onclick="guestLogin()">Guest Mode</button>
  </div>
</div>

<!-- CHAT SCREEN -->
<div id="chatScreen" style="display:none;">
  <h1>DaBoyzz Chat ðŸ”¥</h1>
  <div id="chatBox"></div>
  <br>
  <input id="msgInput" placeholder="Type message...">
  <button id="sendBtn" onclick="sendMessage()">Send</button>
</div>

<script>
  let users = [];
  let username = null;

  // Load user data from the 'user.json' file
  async function loadUsers() {
    try {
      const response = await fetch('user.json'); // Assuming user.json is hosted or available locally
      const data = await response.json();
      users = data.users || [];
    } catch (error) {
      console.error("Error loading user data:", error);
    }
  }

  // Enter chat screen
  function enterChat(name) {
    username = name;
    localStorage.setItem("daboyzz_user", name);
    document.getElementById("loginScreen").style.display = "none";
    document.getElementById("chatScreen").style.display = "block";
  }

  // Handle username login and registration
  async function usernameLogin() {
    const user = document.getElementById("userInput").value.trim();
    const pass = document.getElementById("passInput").value.trim();

    if (!user || !pass) {
      alert("Enter username and password.");
      return;
    }

    const existingUser = users.find(u => u.username === user && u.password === pass);

    if (existingUser) {
      // If user exists, login them
      enterChat(user);
    } else {
      // If user doesn't exist, register them
      users.push({ username: user, password: pass });
      // Normally you'd update 'user.json' on a server-side here
      alert('New user registered');
      enterChat(user);
    }
  }

  // Handle guest login (random guest username)
  function guestLogin() {
    let n = "Guest" + Math.floor(Math.random() * 9000);
    enterChat(n);
  }

  // Simulate message sending (just an example)
  function sendMessage() {
    const text = document.getElementById("msgInput").value.trim();
    if (!text) return;

    document.getElementById("chatBox").innerHTML += `
      <div class="msg">
        <span class="user">${username}:</span> 
        <span class="text">${text}</span>
      </div>
    `;
    document.getElementById("msgInput").value = "";
  }

  // Initialize by loading users from the JSON file
  loadUsers();
</script>

</body>
</html>
